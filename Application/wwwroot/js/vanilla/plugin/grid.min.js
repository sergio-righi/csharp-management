(function(n,t){typeof define=="function"&&define.amd?define(t):typeof exports=="object"?module.exports=t():n.grid=t()})(this,function(){function n(n,t){this.height=[];this.quantity=[];this.row=0;this.column=0;this.columns=0;this.gridWidth=0;this.columnWidth=0;this.grid=n;this.options=s({},{margin:16,columns:4,selector:"",sorted:!1,responsive:[]},t);this.init()}function t(){let n=this;[].forEach.call(this.grid.querySelectorAll(this.options.selector),function(t){let i=new Image;t.firstElementChild!==null&&t.firstElementChild.nodeName==="IMG"?(i.src=t.firstElementChild.src,i.onload=function(){n.add(t)}):n.add(t)})}function f(){this._events={windowResize:o.bind(this)};this.options.responsive.length>0&&window.addEventListener("resize",this._events.windowResize)}function e(){this.options.responsive.length>0&&window.removeEventListener("resize",this._events.windowResize)}function o(){r.call(this);i.call(this);t.call(this)}function i(){this.row=0;this.column=0;this.columns=this.columns===0?this.options.columns:this.columns;this.height=Array(this.columns).fill(0);this.quantity=this.height.slice(0);this.gridWidth=this.grid.offsetWidth;this.columnWidth=this.gridWidth/this.columns-this.options.margin*(this.columns-1)/this.columns}function r(){let n=this.options.responsive;for(let t=0;t<n.length;t++)if(this.gridWidth<n[t][0]){this.columns=n[t][1];break}else this.columns=0}function u(n,t){return window.getComputedStyle(n).getPropertyValue(t)}function s(){for(var t,n=1;n<arguments.length;n++)for(t in arguments[n])arguments[n].hasOwnProperty(t)&&(arguments[0][t]=arguments[n][t]);return arguments[0]}return n.prototype.init=function(){if(this.grid!==undefined)return u(this.grid,"position")!=="relative"&&(this.grid.style.position="relative"),i.call(this),this.options.responsive.length>0&&r.call(this),t.call(this),f.call(this),this},n.prototype.destroy=function(){this.grid!==null&&(e.call(this),this.grid.parentNode.removeChild(this.grid),this.grid=null)},n.prototype.add=function(n){return u(n,"position")!=="absolute"&&(n.style.position="absolute"),n.style.width=this.columnWidth+"px",n.style.top=this.height[this.column]+this.row*this.options.margin+"px",n.style.left=this.column*this.columnWidth+this.column*this.options.margin+"px",this.height[this.column]+=n.clientHeight,this.options.sorted?this.column===this.columns-1?(this.row++,this.column=0):this.column++:(this.quantity[this.column]++,this.column=this.height.indexOf(Math.min.apply(null,this.height)),this.row=this.quantity[this.column]),this.grid.style.height=Math.max.apply(null,this.height)+this.options.margin*Math.max.apply(null,this.quantity)+"px",this},{init:n}});