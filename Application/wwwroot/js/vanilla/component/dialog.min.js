(function(n,t){typeof define=="function"&&define.amd?define(t):typeof exports=="object"?module.exports=t():n.dialog=t()})(this,function(){function f(n){return dataStorage.get(n,"dialog")}function n(n,t){this.index=0;this.code=null;this.allowed=!0;this.element=n;this.options=b({},{onOpen:null,onNext:null,onClose:null,onCancel:null,onConfirm:null,beforeOpen:null,beforeClose:null,closeMethods:["overlay","button","escape"]},t);this.init()}function e(){this.dialog=document.createElement("div");this.dialog.className="dialog";this.popup=document.createElement("div");this.popup.className="dialog-popup";let n=document.createElement("div");if(n.className="dialog-footer",this.hasControl){if(this.hasCheckbox){let i=Math.random().toString(36).substr(2,16);this.checkboxContainer=document.createElement("div");this.checkboxContainer.className="checkbox";this.checkbox=document.createElement("input");this.checkbox.setAttribute("type","checkbox");this.checkbox.id=i;let t=document.createElement("label");t.setAttribute("for",i);t.textContent=this.lblCheckbox;this.checkboxContainer.appendChild(this.checkbox);this.checkboxContainer.appendChild(t);n.appendChild(this.checkboxContainer)}this.hasNext&&(this.nextButton=document.createElement("button"),this.nextButton.setAttribute("type","button"),this.nextButton.className="button mr-2",this.nextButton.textContent=this.lblNext,n.appendChild(this.nextButton));this.hasCancel&&(this.cancelButton=document.createElement("button"),this.cancelButton.setAttribute("type","button"),this.cancelButton.className="button mr-2",this.cancelButton.textContent=this.lblCancel,n.appendChild(this.cancelButton));this.hasConfirm&&(this.confirmButton=document.createElement("button"),this.confirmButton.setAttribute("type","button"),this.confirmButton.className="button button-send button-plain",this.confirmButton.textContent=this.lblConfirm,n.appendChild(this.confirmButton))}this.header=document.createElement("div");this.header.className="dialog-header";this.content=document.createElement("div");this.content.className="dialog-content";i.call(this,0);this.popup.appendChild(this.header);this.popup.appendChild(this.content);this.popup.appendChild(n);this.dialog.appendChild(this.popup);this.element.innerHTML=this.dialog.outerHTML}function o(){this._events={clickNext:c.bind(this),keyboardNav:s.bind(this),clickCancel:l.bind(this),clickConfirm:a.bind(this),clickOverlay:h.bind(this),animationEnd:y.bind(this),triggerButton:v.bind(this)};this.options.closeMethods.indexOf("button")!==-1&&(this.hasCancel&&this.cancelButton.addEventListener("click",this._events.clickCancel.bind(!0)),this.hasConfirm&&this.confirmButton.addEventListener("click",this._events.clickConfirm.bind(!0)),this.hasNext&&this.nextButton.addEventListener("click",this._events.clickNext.bind(!0)));this.dialog.addEventListener("mousedown",this._events.clickOverlay);document.addEventListener("keydown",this._events.keyboardNav);this.buttons=document.querySelectorAll(`[data-dialog="#${this.element.id}"]`);for(let n=0;n<this.buttons.length;n++)this.buttons[n].addEventListener("click",this._events.triggerButton)}function s(n){this.options.closeMethods.indexOf("escape")!==-1&&n.which===u.esc&&this.isOpen()&&this.close()}function h(n){this.options.closeMethods.indexOf("overlay")!==-1&&!p(n.target,"dialog")&&n.clientX<this.dialog.clientWidth&&this.close()}function c(){this.close.call(this,!1);typeof this.options.onNext=="function"&&this.options.onNext.call(this)}function l(){this.close.call(this,!0);typeof this.options.onCancel=="function"&&this.options.onCancel.call(this)}function a(){this.close.call(this,!0);typeof this.options.onConfirm=="function"?this.options.onConfirm.call(this):this.element.dispatchEvent(new CustomEvent("dialog.confirm",{detail:this}))}function v(n){n.target&&n.target.hasAttribute("data-dialog")&&n.target.getAttribute("disabled")===null&&(n.target.href!==undefined&&(n.preventDefault(),n.stopImmediatePropagation(),this.options.onConfirm=function(){window.location.href=n.target.href}),this.setHeader(n.target.dataset.header),this.setContent(n.target.dataset.content),this.open())}function y(n){this.popup.removeEventListener("animationend",this._events.animationEnd);this.popup.classList.remove("animation-open");this.popup.classList.remove("animation-close");this.popup.classList.remove("animation-block");n.animationName==="scale_out"&&this.dialog.classList.remove("active")}function p(n,t){while((n=n.parentElement)&&!n.classList.contains(t));return n}function w(){if(this.options.closeMethods.indexOf("button")!==-1&&(this.hasCancel&&this.cancelButton.removeEventListener("click",this._events.clickClose),this.hasConfirm&&this.confirmButton.removeEventListener("click",this._events.clickClose),this.hasNext&&this.nextButton.removeEventListener("click",this._events.clickNext)),this.dialog.removeEventListener("mousedown",this._events.clickOverlay),document.removeEventListener("keydown",this._events.keyboardNav),this.buttons!==undefined)for(let n=0;n<this.buttons.length;n++)this.buttons[n].removeEventListener("click",this._events.triggerButton)}function i(n){if(this.items[n]!==undefined){let t=this.items[n].querySelectorAll("[data-header]")[0];t!==undefined&&this.setHeader(t.innerHTML);let i=this.items[n].querySelectorAll("[data-content]")[0];i!==undefined&&this.setContent(i.innerHTML)}}function r(n){this.index=n;let t=this.items[n];n===this.items.length-1?(this.hasCancel&&this.cancelButton.classList.remove("d-none"),this.hasNext&&this.nextButton.classList.add("d-none"),this.allowed=!0):n===0?(this.hasCancel&&this.cancelButton.classList.add("d-none"),this.hasNext&&this.nextButton.classList.remove("d-none"),this.allowed=!1):(this.hasCancel&&this.cancelButton.classList.add("d-none"),this.hasNext&&this.nextButton.classList.remove("d-none"));t.dataset.code?(this.hasNext&&this.checkboxContainer.classList.remove("d-none"),this.code=parseInt(t.dataset.code,10)):(this.code=null,this.hasNext&&this.checkboxContainer.classList.add("d-none"));this.checkbox!==undefined&&(this.checkbox.checked=!1);this.items.length>1&&this.header.setAttribute("data-text",`${n+1}/${this.items.length}`);i.call(this,n)}function b(){for(var t,n=1;n<arguments.length;n++)for(t in arguments[n])arguments[n].hasOwnProperty(t)&&(arguments[0][t]=arguments[n][t]);return arguments[0]}const u={esc:27};let t=!1;return n.prototype.init=function(){if(this.element!==null)return this.hasCancel=this.element.dataset.cancel!==undefined?!0:!1,this.hasConfirm=this.element.dataset.confirm!==undefined?!0:!1,this.hasCheckbox=this.element.dataset.checkbox!==undefined?!0:!1,this.hasControl=this.hasCancel||this.hasConfirm||this.hasCheckbox?!0:!1,this.lblCancel=this.hasCancel?this.element.dataset.cancel:"",this.lblConfirm=this.hasConfirm?this.element.dataset.confirm:"",this.lblNext=this.element.dataset.next!==undefined?this.element.dataset.next:"",this.lblCheckbox=this.element.dataset.checkbox!==undefined?this.element.dataset.checkbox:"",this.items=this.element.querySelectorAll("[data-item]"),this.hasNext=this.items.length>1?!0:!1,e.call(this),o.call(this),dataStorage.put(this.element,"dialog",this),document.body.insertBefore(this.dialog,document.body.firstChild),this},n.prototype._busy=function(n){t=n},n.prototype._isBusy=function(){return t},n.prototype.destroy=function(){this.dialog!==null&&(this.isOpen()&&this.close(!0),w.call(this),this.dialog.parentNode.removeChild(this.dialog),this.dialog=null)},n.prototype.isOpen=function(){return!!this.dialog.classList.contains("active")},n.prototype.open=function(){if(!this._isBusy())return this._busy(!0),typeof this.options.beforeOpen=="function"&&this.options.beforeOpen(),this.hasNext&&r.call(this,0),document.body.classList.add("o-hidden"),this.dialog.classList.add("active"),this.popup.classList.add("animation-open"),this.popup.addEventListener("animationend",this._events.animationEnd),typeof this.options.onOpen=="function"?this.options.onOpen.call(this):this.element.dispatchEvent(new CustomEvent("dialog.open",{detail:this})),this._busy(!1),this},n.prototype.close=function(n){if(!this._isBusy()){if(this._busy(!0),n=n||!1,!this.hasConfirm||n)if(this.items.length>0&&!this.allowed)this.next();else{if(typeof this.options.beforeClose=="function"){let n=this.options.beforeClose.call(this);if(!n){this._busy(!1);return}}document.body.classList.remove("o-hidden");typeof this.options.onClose=="function"?this.options.onClose.call(this):this.element.dispatchEvent(new CustomEvent("dialog.close",{detail:this}));this.popup.classList.add("animation-close");this.popup.addEventListener("animationend",this._events.animationEnd)}else this.popup.classList.add("animation-block"),this.popup.addEventListener("animationend",this._events.animationEnd);this._busy(!1)}},n.prototype.set=function(n,t){this.setHeader(n);this.setContent(t)},n.prototype.setHeader=function(n){n!==undefined&&(this.header.innerHTML=n)},n.prototype.setContent=function(n){n!==undefined&&(this.content.innerHTML=n)},n.prototype.next=function(){this.element.dispatchEvent(new CustomEvent("dialog.next",{detail:this}));r.call(this,this.index===this.items.length-1?this.index:this.index+1)},{init:n,get:f}});